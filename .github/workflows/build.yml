name: Push to GCR GitHub Action
on: [push]
jobs:
  build-and-push-to-gcr:
    runs-on: ubuntu-latest
    steps:
    - id: 'auth'
      uses: actions/checkout@v2
      with:
        service_account_key: ${{ secrets.SVE_CREDENTIALS }}
        project_id: sve-backend
        export_default_credentials: true
     - name: 'image'
       run: docker build --build-arg SVE_CREDENTIALS=${{ secrets.SVE_CREDENTIALS }} --build-arg SVE_EMAILS=${{ secrets.SVE_EMAILS }} -t eu.gcr.io/sve-backend/sve_backend .
     - run: gcloud auth configure-docker -q
     - name: 'push'
       run: docker push eu.gcr.io/sve-backend/sve_backend
